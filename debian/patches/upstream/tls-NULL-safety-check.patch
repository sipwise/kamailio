From: S-P Chan <shihping.chan@gmail.com>
Date: Tue, 5 Mar 2024 09:59:41 +0800
Subject: tls: NULL safety check

(cherry picked from commit f6f9d90ada963b53b6552e1a172b8f2fd021c33b)
---
 src/modules/tls/tls_mod.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/src/modules/tls/tls_mod.c b/src/modules/tls/tls_mod.c
index 51e88be..c2a3c8d 100644
--- a/src/modules/tls/tls_mod.c
+++ b/src/modules/tls/tls_mod.c
@@ -871,6 +871,8 @@ EVP_PKEY *tls_engine_private_key(const char *key_id)
 
 	while(!(OSSL_STORE_eof(ctx))) {
 		OSSL_STORE_INFO *info = OSSL_STORE_load(ctx);
+		if(info == NULL)
+			continue;
 
 		int type;
 		type = OSSL_STORE_INFO_get_type(info);
