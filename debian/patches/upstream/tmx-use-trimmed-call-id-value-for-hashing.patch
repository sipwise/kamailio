From: Daniel-Constantin Mierla <miconda@gmail.com>
Date: Wed, 16 Feb 2022 12:45:33 +0100
Subject: [PATCH] tmx: use trimmed call-id value for hashing

(cherry picked from commit 88f1a1a671c4486e5000415b3d52eb42e6ad4cbb)
---
 src/modules/tmx/tmx_pretran.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/modules/tmx/tmx_pretran.c b/src/modules/tmx/tmx_pretran.c
index 256c82b..7bb2315 100644
--- a/src/modules/tmx/tmx_pretran.c
+++ b/src/modules/tmx/tmx_pretran.c
@@ -243,7 +243,7 @@ int tmx_check_pretran(sip_msg_t *msg)
 	sftag = get_from(msg)->tag_value;
 	trim(&sftag);
 
-	chid = get_hash1_raw(msg->callid->body.s, msg->callid->body.len);
+	chid = get_hash1_raw(scallid.s, scallid.len);
 	slotid = chid & (_tmx_ptran_size-1);
 
 	if(unlikely(_tmx_proc_ptran == NULL)) {
