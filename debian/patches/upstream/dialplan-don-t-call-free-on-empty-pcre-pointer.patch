From: Victor Seva <linuxmaniac@torreviejawireless.org>
Date: Thu, 30 May 2024 14:59:05 +0200
Subject: dialplan: don't call free on empty pcre pointer

fixes #3851
---
 src/modules/dialplan/dp_repl.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/src/modules/dialplan/dp_repl.c b/src/modules/dialplan/dp_repl.c
index 42ba3b4..51cab40 100644
--- a/src/modules/dialplan/dp_repl.c
+++ b/src/modules/dialplan/dp_repl.c
@@ -648,7 +648,8 @@ search_rule:
 							LM_DBG("match check skipped: [%.*s] %d\n",
 									re_list->expr.len, re_list->expr.s, rez);
 						rt = re_list->next;
-						pcre2_match_data_free(pcre_md);
+						if(pcre_md)
+							pcre2_match_data_free(pcre_md);
 						pcre2_code_free(re_list->re);
 						pkg_free(re_list);
 						re_list = rt;
